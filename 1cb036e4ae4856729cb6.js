(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{113:function(e,t,r){"use strict";var i=r(88);r.n(i).a},114:function(e,t,r){"use strict";var i=r(89);r.n(i).a},115:function(e,t,r){"use strict";var i=r(90);r.n(i).a},116:function(e,t,r){"use strict";var i=r(91);r.n(i).a},131:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"reviews"},[r("div",{staticClass:"container"},[r("p",{staticClass:"page__title reviews__title"},[e._v("\n      Блок «Отзывы»\n    ")]),e._v(" "),e.reviewForm?r("review-form",{staticClass:"review-form__comp",attrs:{"is-editing":e.isEditing,review:e.editedReview},on:{cancel:function(t){e.reviewForm=!1},"add-review":e.addReview,"edit-review":e.editReview}}):e._e(),e._v(" "),r("ul",{staticClass:"review__list"},[r("li",{staticClass:"review__item"},[r("square-btn",{attrs:{type:"square",title:"Добавить отзыв",disabled:e.reviewForm},on:{click:e.reviewFormHandler}})],1),e._v(" "),e._l(e.reviews,(function(t){return r("li",{key:t.id,staticClass:"review__item"},[r("review",{attrs:{review:t,"cancel-editing":e.isEditing},on:{"edit-review":e.editReviewHandler,"delete-review":e.deleteReview}})],1)}))],2)],1)])};i._withStripped=!0;var n=r(0),o=r.n(n),a=r(1),s=r.n(a),c=r(18),l=r.n(c),v=r(67),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",{class:{editing:e.isEditing}},[r("div",{staticClass:"review__top",attrs:{slot:"title"},slot:"title"},[r("div",{staticClass:"review__img-wrapper"},[r("img",{staticClass:"review__img",attrs:{src:e.coverPhoto}})]),e._v(" "),r("div",{staticClass:"review__author-wrapper"},[r("p",{staticClass:"review__author"},[e._v("\n        "+e._s(e.review.author)+"\n      ")]),e._v(" "),r("p",{staticClass:"review__occ"},[e._v("\n        "+e._s(e.review.occ)+"\n      ")])])]),e._v(" "),r("div",{staticClass:"review__block",attrs:{slot:"content"},slot:"content"},[r("p",{staticClass:"review__text"},[e._v("\n      "+e._s(e.review.text)+"\n    ")]),e._v(" "),r("div",{staticClass:"review__btns"},[r("icon",{staticClass:"review__btn-edit",attrs:{symbol:"pencil",title:"Править"},on:{click:e.editHandler}}),e._v(" "),r("icon",{staticClass:"review__btn-delete",attrs:{symbol:"cross",title:"Удалить"},on:{click:function(t){return e.$emit("delete-review",e.review.id)}}})],1)])])};u._withStripped=!0;var d=r(68),p=r(58),w=r(5),f={components:{card:d.a,icon:p.a},props:{review:{type:Object,default:function(){return{title:null,photo:{},link:null,description:null}}},cancelEditing:{type:Boolean,default:!0}},data:function(){return{isEditing:!1}},computed:{coverPhoto:function(){return"".concat(w.BASE_URL,"/").concat(this.review.photo)}},methods:{editHandler:function(){window.scrollTo({top:0,behavior:"smooth"}),this.isEditing=!0,this.$emit("edit-review",this.review)}}},h=(r(113),r(17)),_=Object(h.a)(f,u,[],!1,null,"784b16e2",null);_.options.__file="src/admin/components/review/review.vue";var m=_.exports,b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",[e.isEditing?r("p",{staticClass:"review-form__title",attrs:{slot:"title"},slot:"title"},[e._v("\n    Редактирование отзыва\n  ")]):r("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n    Новый отзыв\n  ")]),e._v(" "),r("template",{slot:"content"},[r("validation-observer",{ref:"review-form",staticClass:"review-form",attrs:{tag:"div"}},[r("add-photo",{staticClass:"review-form__add",attrs:{avatar:e.currentReview.preview},on:{"add-photo":e.addPhoto,"render-photo":e.renderPhoto}}),e._v(" "),r("div",{staticClass:"review-form__wrapper"},[r("div",{staticClass:"review-form__author"},[r("div",{staticClass:"review-form__author-name"},[r("label",{staticClass:"review-form__label",attrs:{for:"author"}},[e._v("Имя автора")]),e._v(" "),r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[r("app-input",{staticClass:"review-form__input",attrs:{id:"author","error-message":i[0]?"Не введено имя автора":""},model:{value:e.currentReview.author,callback:function(t){e.$set(e.currentReview,"author",t)},expression:"currentReview.author"}})]}}])})],1),e._v(" "),r("div",{staticClass:"review-form__author-occ"},[r("label",{staticClass:"review-form__label",attrs:{for:"occ"}},[e._v("Титул автора")]),e._v(" "),r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[r("app-input",{staticClass:"review-form__input",attrs:{id:"occ","error-message":i[0]?"Не введен титул автора":""},model:{value:e.currentReview.occ,callback:function(t){e.$set(e.currentReview,"occ",t)},expression:"currentReview.occ"}})]}}])})],1)]),e._v(" "),r("label",{staticClass:"review-form__label",attrs:{for:"text"}},[e._v("Отзыв")]),e._v(" "),r("app-input",{staticClass:"review-form__input review-form__input--text",attrs:{id:"text","field-type":"textarea"},model:{value:e.currentReview.text,callback:function(t){e.$set(e.currentReview,"text",t)},expression:"currentReview.text"}}),e._v(" "),r("div",{staticClass:"review-form__btns"},[r("app-button",{attrs:{title:"Отмена",plain:""},on:{click:function(t){return e.$emit("cancel")}}}),e._v(" "),r("app-button",{staticClass:"review-form__btn",style:{paddingBottom:0,paddingTop:0},attrs:{title:"Сохранить"},on:{click:e.submitHandler}})],1)],1)],1)],1)],2)};b._withStripped=!0;var O=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{class:["add-photo__wrapper",{hovered:this.hovered},{avatar:this.avatar}],style:{backgroundImage:"url('"+this.avatar+"')"}},[t("label",{staticClass:"add-photo__label uploader",on:{dragover:this.handleDragOver,drop:this.addPhoto}})]),this._v(" "),t("app-button",{staticClass:"add-photo__btn",attrs:{title:"Добавить фото","type-attr":"file",plain:""},on:{change:this.addPhoto}})],1)};O._withStripped=!0;var y=r(7);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R={components:{appButton:v.a},props:{avatar:{type:String,default:""}},data:function(){return{hovered:!1}},methods:j(j({},Object(y.b)({showTooltip:"tooltip/show"})),{},{addPhoto:function(e){e.preventDefault();var t=e.dataTransfer?e.dataTransfer.files[0]:e.target.files[0];this.$emit("add-photo",t),this.renderPhoto(t)},renderPhoto:function(e){var t=this,r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t.$emit("render-photo",r.result)},r.onerror=function(){t.showTooltip({text:"Фотография не была загружена",type:"error"})},r.onabort=function(){t.showTooltip({text:"Невозможно прочитать файл",type:"error"})}},handleDragOver:function(e){e.preventDefault(),this.hovered=!0}})},P=(r(114),Object(h.a)(R,O,[],!1,null,"16690a46",null));P.options.__file="src/admin/components/add-photo/add-photo.vue";var C=P.exports,x=r(57),k=r(63),E=r(66);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object(k.c)("required",E.c);var $={components:{card:d.a,addPhoto:C,appInput:x.a,appButton:v.a,ValidationProvider:k.b,ValidationObserver:k.a},props:{empty:{type:Boolean,default:!1},review:{type:Object,default:function(){return{id:null,title:"",link:"",description:"",techs:"",photo:{},preview:""}}},isEditing:{type:Boolean,default:!1}},data:function(){return{currentReview:S({},this.review)}},watch:{review:{handler:function(e){this.currentReview=S({},e),this.isEditing&&0!==Object.keys(this.currentReview.photo).length&&(this.currentReview.preview="".concat(w.BASE_URL,"/").concat(this.review.photo))},deep:!0,immediate:!0}},methods:{addPhoto:function(e){this.currentReview.photo=e},renderPhoto:function(e){this.currentReview.preview=e},submitHandler:function(){var e=this;this.$refs["review-form"].validate().then((function(t){if(t){var r=S({},e.currentReview);delete r.preview,e.isEditing?e.$emit("edit-review",r):e.$emit("add-review",r)}}))}}},T=(r(115),Object(h.a)($,b,[],!1,null,"4a18c47a",null));T.options.__file="src/admin/components/review-form/review-form.vue";var F=T.exports;function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H={name:"Reviews",components:{squareBtn:v.a,review:m,reviewForm:F},data:function(){return{reviewForm:!1,isEditing:!1,editedReview:{id:null,photo:null,author:null,occ:null,text:null,preview:null}}},computed:B({},Object(y.c)("reviews",{reviews:function(e){return e.data}})),created:function(){this.fetchReviewsAction()},methods:B(B({},Object(y.b)({addReviewAction:"reviews/add",fetchReviewsAction:"reviews/fetch",editReviewAction:"reviews/edit",deleteReviewAction:"reviews/delete",showTooltip:"tooltip/show"})),{},{addReview:function(e){var t=this;return s()(o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.addReviewAction(e);case 3:t.reviewForm=!1,t.showTooltip({text:"Отзыв успешно создан",type:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.showTooltip({text:r.t0.message,type:"error"});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},editReviewHandler:function(e){this.reviewForm=!0,this.isEditing=!0,this.editedReview=e,this.editedReview.preview=null},editReview:function(e){var t=this;return s()(o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.editReviewAction(e);case 3:t.reviewForm=!1,t.showTooltip({text:"Отзыв успешно изменен",type:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.showTooltip({text:"Не удалось изменить отзыв",type:"error"});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},deleteReview:function(e){var t=this;return s()(o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.deleteReviewAction(e);case 3:t.showTooltip({text:"Отзыв успешно удален",type:"success"}),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),t.showTooltip({text:"Не удалось удалить отзыв",type:"error"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},reviewFormHandler:function(){this.reviewForm=!0,this.editedReview={id:null,title:"",link:"",description:"",techs:"",photo:{},preview:""}}})},q=(r(116),Object(h.a)(H,i,[],!1,null,"3cba2bf0",null));q.options.__file="src/admin/components/pages/reviews/reviews-page.vue";t.default=q.exports},88:function(e,t,r){},89:function(e,t,r){},90:function(e,t,r){},91:function(e,t,r){}}]);